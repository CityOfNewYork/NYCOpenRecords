
{% extends "case.html" %}
{% block title %}Request {{ req.id }}{% endblock %}
{% block custom_css_links %}
    <!-- used for the extension and close request multi-select boxes in city view -->
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/manage_request_city_less_js.css') }}">
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/sidebar.css') }}">
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/bottom_sidebar.css') }}">
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/case.css') }}">
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/plugins/bootstrap-select.min.css') }}">
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/plugins/bootstrap-fileupload.css') }}">
{% endblock custom_css_links %}

{% block requester_info %}
  <div>
    {% set alias = "Not provided" %}
    {% set phone = "Not provided" %}
    {% set requester = req.requester() %}
    {% if requester %}
       {% set user = requester.user %}
       {% set email = user.email %}
       {% set alias = user.alias %}
       {% set phone = user.phone %}
       {% set address1 = user.address1 %}
       {% set address2 = user.address2 %}
       {% set city = user.city %}
       {% set state = user.state %}
       {% set zipcode = user.zipcode %}
    {% endif %}
    {% if not email %}
      <span id="no_email">
        <strong><i class="icon icon-exclamation-sign"></i> Requester's e-mail has not been provided.</strong>
      </span>
    <small>
    {% endif %}
      <br>
      <span>
        Requester's Name: <span class="label">{{ alias or "Not provided" }}</span></span>
      </span>
      <br>
      <span>
        Requester's Phone Number: <span class="label">{{ phone or "Not provided" }}</span>
      </span>
      <br>
      <span>
        Requester's Street Address: <span class="label">{{ address1 or "Not provided" }}</span>
      </span>
      <br>
      <span>
        Requester's City: <span class="label">{{ city or "Not provided" }}</span>
      </span>
      <br>
      <span>
        Requester's State: <span class="label">{{ state or "Not provided" }}</span>
      </span>
      <br>
      <span>
        Requester's Zipcode: <span class="label">{{ zipcode or "Not provided" }}</span>
      </span>
    </small>
  </div>
{% endblock requester_info %}

{% block proxyrequester_info %}
  {{ super() }}
{% endblock proxyrequester_info %}

{% block clarify_request %}
  <!-- ask a question -->
  <form name="ask_question" id="question" class="form-inline" style="margin: 10px 0px 15px 0px;" method="post" action="/add_a_qa" autocomplete="on">
    <input type="hidden" name="request_id" value="{{ req.id }}"/>
    <fieldset>
      <label>Ask a question <span rel="tooltip" data-toggle="tooltip" data-placement="right" title="" data-original-title="{{"Ask a question" | explain_action }}"><small><i class="icon-info-sign"></i></small></span></label>
      <textarea id="questionTextarea"  name="question_text" class="input-xlarge" placeholder="Ask the requester a question" required/></textarea>
      <button id="askQuestion" class="btn btn-primary" type="submit">Ask</button>
    </fieldset>
  </form>
{% endblock clarify_request %}

{% block response_actions_lessjs %}
  <h3 style="margin-top:40px;">Response actions</h3>
  <!-- Add a note form -->
  <form name="note" class="form-horizontal" id="note" method="post" action="/add_a_note">
    <input type="hidden" name="request_id" value="{{ req.id }}"/>
    <fieldset>
      <legend>Add a note</legend>
      <div class="row-fluid">
        <div class="control-group">
          <label class="control-label">Note <span rel="tooltip" data-toggle="tooltip" data-placement="right" title="" data-original-title="{{"Add a note"| explain_action }}"><small><i class="icon-info-sign"></i></small></span></label>
          <div class="controls">
            <textarea type="text" class="input-xxlarge" id="noteTextarea" name="note_text"  placeholder="Anything else the requester should know."required/></textarea>
          </div>
        </div>
        <div class="control-group">
          <div class="controls">
            <button type="submit" class="btn btn-primary">Add note</button>
          </div>
          <label class="control-label">Privacy <span rel="tooltip" data-toggle="tooltip" data-placement="right" title="" data-original-title="Privacy"><small><i class="icon-info-sign"></i></small></span></label>
          <div class="controls">
            <select id="note_privacy" name="note_privacy" required data-selected-text-format="count" size="2">
              <option selected value="2">Staff Only</option>
            </select>
          </div>
        </div>
      </div>
    </fieldset>
  </form>
{% endblock response_actions_lessjs %}

{% block sidebar %}

  {% block status %}
    {% set status = req.solid_status() %}
    {% include '_manage_requests_status.html' %}
  {% endblock status %}

  <div class="b_sidebar">
    <div class="row-fluid participantRow">
        <h4 class="case_participantRow">Point of Contact</h4>
        {% include '_contact_popover.html' %}
    </div>
    <div class="row-fluid participantRow">
        <h4 class="case_participantRow">Helpers</h4>
        {% include '_staff_participants.html' %}
    </div>
    <div class="row-fluid">
      <div class="participantRow-history">
        {% include '_history.html' %}
      </div>
    </div>
  </div>

{% endblock sidebar %}

{% block request_dates %}
  {{super()}}
  <div class="text-center">Due: <span class="label">{{ req.due_date | date }}</span></div>
{% endblock request_dates %}

{% block follow %}{% endblock follow %}

{% block custom_script_links %}
  <script type="text/javascript" src="{{ url_for('static', filename='js/case.js') }}"></script>
{% endblock custom_script_links %}
